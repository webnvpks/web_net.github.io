<title>Создание в системе виртуальной машины для исполнения приложений.</title>
<link rel="shortcut icon" href="../../img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../css/css.css">
<meta charset="utf-8">
<script src="../../js/jquery-3.3.1.min.js"></script>
<script src="../../js/vision_js.js"></script><script src="../../js/slide_js.js"></script>
<div class="body">
    <p class="vision" title="Версия для слабовидящих" onclick="cl()">
        <svg width="50" height="50" viewBox="0 0 1750 1750" xmlns="http://www.w3.org/2000/svg">
            <path fill="#ffffff"
                d="M1664 960q-152-236-381-353 61 104 61 225 0 185-131.5 316.5t-316.5 131.5-316.5-131.5-131.5-316.5q0-121 61-225-229 117-381 353 133 205 333.5 326.5t434.5 121.5 434.5-121.5 333.5-326.5zm-720-384q0-20-14-34t-34-14q-125 0-214.5 89.5t-89.5 214.5q0 20 14 34t34 14 34-14 14-34q0-86 61-147t147-61q20 0 34-14t14-34zm848 384q0 34-20 69-140 230-376.5 368.5t-499.5 138.5-499.5-139-376.5-368q-20-35-20-69t20-69q140-229 376.5-368t499.5-139 499.5 139 376.5 368q20 35 20 69z">
            </path>
        </svg>
    </p>
</div>
<div class="header"></div>
<div class="hat"><div class="sandwich" onclick="OpenMenu()">>>></div>
    <p class="name">
        Внедрение и поддержка компьютерных систем
    </p>
    <div class="links">
        <a href="../../../index.html" class="link">Главная</a>
        <a href="../lectures.html" class="link" title="Лекции">Лекции</a>
        <a href="../video.html" class="link" title="Видео-уроки">Видео-уроки</a>
        <a href="../laboratornie.html" class="link" title="Лабораторные работы">Лабораторные работы</a>

    </div>
</div>
<div class="content">
    <h1>Создание в системе виртуальной машины для исполнения приложений.</h1>
    <h2>Режим виртуальных машин для исполнения приложений реального режима</h2>
    <p>Разработчики рассматриваемого семейства микропроцессоров в своем стремле&shy;нии обеспечить максимально возможную
        совместимость архитектуры пошли не только на то, чтобы обеспечить возможность программам, созданным для первых
        16-разрядных ПК, без проблем выполняться на компьютерах с более поздними моделями микропроцессоров за счёт
        введения реального режима работы. Они также обеспечили возможность выполнения 16-разрядных приложений реального
        режима при условии, что сам процессор при этом функционирует в защищённом режиме работы и операционная система,
        используя соответствующие аппаратные средства микропроцессора, организует мультипрограммный (мультизадачный)
        режим. Другими словами, микропроцессоры i80x86 поддерживают возможность создания операционных сред реального
        режима при работе микропроцессора в защищённом режиме. Если условно назвать 16-разрядные приложения
        DOS-приложениями (поскольку в абсолютном большинстве случаев это именно так), то можно сказать, что введена
        поддержка для организации виртуальных DOS-машин, работающих вместе с обычными 32-битовыми приложениями
        защищён&shy;ного режима. Это даже нашло отражение в названии режима работы микропро&shy;цессоров i80x86 &ndash;
        режим виртуального процессора i8086, иногда (для краткости) его называют режимом V86 или просто <em>виртуальным
            режимом,&nbsp;</em>&ndash; при котором в защищённом режиме работы может исполняться код DOS-приложения.
        Мультизадачность при выполнении нескольких программ реального режима будет поддержана аппаратными средствами
        защищённого режима.</p>
    <p>Переход в виртуальный режим осуществляется посредством изменения бита VM(virtualmode) в регистре EFLAGS. Когда
        процессор находится в виртуальном режиме, для адресации памяти используется схема реального режима работы
        &ndash; (сегмент: смещение) с размером сегментов до 64 Кбайт, которые могут распола&shy;гаться в адресном
        пространстве размером в 1 Мбайт, однако полученные адреса считаются не физическими, а линейными. В результате
        применения страничной трансляции осуществляется отображение виртуального адресного пространства 16-битового
        приложения на физическое адресное пространство. Это позволяет организовать параллельное выполнение нескольких
        задач, разработанных для реального режима, да ещё и совместно с обычными 32-битовыми приложениями, требующих
        защищённого режима работы. Естественно, что для обработки прерываний, возникающих при выполнении 16-битовых
        приложений в виртуальном режиме, процессор возвращается из этого режима в обычный защищённый режим. В противном
        случае невозможно было бы организовать полноценную виртуальную машину. Очевидно, что обработчи&shy;ки прерываний
        для виртуальной машины должны эмулировать работу подсисте&shy;мы прерываний процессораi8086. Другими словами,
        прерывания отображаются в операционную систему, работающую в защищённом режиме, и уже основная ОС моделирует
        работу операционной среды выполняемого приложения.</p>
    <p>Вопрос, связанный с операциями ввода/вывода, которые недоступны для обыч&shy;ных приложений, решается аналогично.
        При попытке выполнить недопустимые команды ввода/вывода возникают прерывания, и не&shy;обходимые операции
        выполняются операционной системой, хотя задача об этом и &laquo;не подозревает&raquo;. При выполнении команд
        IN,OUT,INS,OUTS,CLI,STIпроцессор, находящийся в виртуальном режиме и исполняющий код на уровне привилегий
        третьего (самого нижнего) кольца защиты, за счёт возникающих вследствие этого прерываний переводится на
        выполнение высоко привилегированного кода опе&shy;рационной системы.</p>
    <p>Таким образом, ОС может полностью виртуализировать ресурсы компьютера: и аппаратные, и программные, создавая иную
        полноценную операционную сре&shy;ду; при существовании так называемых нативных приложений, создаваемых по
        собственным спецификациям данной ОС. Очень важным моментом для органи&shy;зации полноценной виртуальной машины
        является реализация виртуализации не только программных, но и аппаратных ресурсов. Так, например, в
        ОСWin&shy;dowsNTэта задача выполнена явно неудачно, тогда как в OS/2 имеется полно&shy;ценная виртуальная машина
        как для DOS-приложений, так и для приложений, работающих в среде спецификацийWin16. Правда, в последнее время
        это уже перестало быть актуальным, поскольку появилось большое количество приложе&shy;ний, работающих по
        спецификациям Win32API.</p>
    <h2>Создание виртуальной машины с помощью Hyper-V в Windows10</h2>
    <p>Создание виртуальной машины и установка на нее операционной системы. Вам потребуется ISO-файл для операционной
        системы, которую требуется запустить.</p>
    <h3>Создание виртуальной машины с помощью диспетчера Hyper-V</h3>
    <ol>
        <li>
            <p>Откройте диспетчер Hyper-V, нажав клавишу Windows и введя в строке поиска "диспетчер Hyper-V", выполните
                поиск&nbsp;<strong>диспетчера Hyper-V</strong>&nbsp;в своих приложениях.</p>
        </li>
        <li>
            <p>В диспетчере Hyper-V
                щелкните&nbsp;<strong>Действие</strong>&nbsp;&gt;&nbsp;<strong>Создать</strong>&nbsp;&gt;&nbsp;<strong>Виртуальная
                    машина</strong>, чтобы открыть мастер создания виртуальной машины.</p>
        </li>
        <li>
            <p>Просмотрите содержимое страницы "Приступая к работе" и нажмите кнопку&nbsp;<strong>Далее</strong>.</p>
        </li>
        <li>
            <p>Присвойте имя виртуальной машине.</p>
            <blockquote>
                <p><strong>Примечание.</strong>&nbsp;Это имя, используемое Hyper-V для виртуальной машины, а не имя
                    компьютера, присвоенное гостевой операционной системе, которая будет развернута внутри виртуальной
                    машины.</p>
            </blockquote>
        </li>
        <li>
            <p>Выберите расположение, где будут храниться файлы виртуальной машины
                (например,&nbsp;<strong>c:\virtualmachine</strong>). Можно также оставить расположение по умолчанию. По
                завершении нажмите кнопку&nbsp;<strong>Далее</strong>.</p>
            <p class="img"><img src="zagruzka_i_ustanovka_programmnogo_obespecheniya6_pic1.png" /></p>
        </li>
        <li>
            <p>Выберите поколение виртуальной машины и нажмите кнопку&nbsp;<strong>Далее</strong>.</p>
            <p>В виртуальных машинах поколения 2, которые появились в Windows Server 2012 R2, доступна упрощенная модель
                виртуального оборудования и некоторые дополнительные функциональные возможности. На виртуальную машину
                поколения 2 можно установить только 64-разрядную версию операционной системы.</p>
            <blockquote>
                <p>Если новая виртуальная машина относится к поколению 2 и будет работать под управлением дистрибутива
                    Linux, потребуется отключить безопасную загрузку.</p>
            </blockquote>
        </li>
        <li>
            <p>Выберите&nbsp;<strong>2048</strong>МБ в качестве значения параметра&nbsp;<strong>Память, выделяемая при
                    запуске</strong>&nbsp;и не снимайте флажок&nbsp;<strong>Использовать динамическую память</strong>.
                Нажмите кнопку&nbsp;<strong>Далее</strong>.</p>
            <p>Память распределяется между узлом Hyper-V и виртуальной машиной, работающей на этом узле. Число
                виртуальных машин, которые могут работать на одном узле, зависит, в частности, от объема доступной
                памяти. Виртуальную машину можно также настроить для использования динамической памяти. При включении
                динамическая память высвобождает неиспользуемую память работающей виртуальной машины. Это позволяет
                большему количеству виртуальных машин работать на узле.</p>
        </li>
        <li>
            <p>В мастере настройки сети выберите для данной виртуальной машины виртуальный коммутатор и нажмите
                кнопку&nbsp;<strong>Далее</strong>. </p>
        </li>
        <li>
            <p>Присвойте имя виртуальному жесткому диску, выберите расположение или оставьте значение по умолчанию, а
                затем укажите размер. По окончании нажмите кнопку&nbsp;<strong>Далее</strong>.</p>
            <p>Виртуальный жесткий диск представляет собой память для виртуальной машины, чем напоминает физический
                жесткий диск. Виртуальный жесткий диск требуется для установки операционной системы на виртуальной
                машине.</p>
            <p class="img"><img src="zagruzka_i_ustanovka_programmnogo_obespecheniya6_pic2.png" /></p>
        </li>
        <li>
            <p>В мастере параметров установки выберите элемент&nbsp;<strong>Установить операционную систему из файла
                    загрузочного образа</strong>, а затем выберите ISO-файл нужной операционной системы. Нажмите
                кнопку&nbsp;<strong>Далее</strong>&nbsp;после завершения.</p>
            <p>При создании виртуальной машины можно настроить некоторые параметры установки операционной системы.
                Доступны три варианта.</p>
            <ul>
                <li>
                    <p><strong>Установить операционную систему позднее</strong>. Этот параметр не вносит какие-либо
                        дополнительные изменения в виртуальную машину.</p>
                </li>
                <li>
                    <p><strong>Установить операционную систему из файла загрузочного образа</strong>. Действие этого
                        параметра аналогично вставке компакт-диска в физический дисковод компьютера. Чтобы настроить
                        этот параметр, выберите ISO-образ. Этот образ будет подключен к дисководу виртуальной машины.
                        Меняется порядок загрузки виртуальной машины: загрузка начинается с дисковода.</p>
                </li>
                <li>
                    <p><strong>Установить операционную систему с сетевого сервера установки</strong>. Этот параметр
                        доступен только тогда, когда виртуальная машина подключена к сетевому коммутатору. В этой
                        конфигурации виртуальная машина предпринимает попытки загрузиться из сети.</p>
                </li>
            </ul>
        </li>
        <li>
            <p>Просмотрите информацию о данной виртуальной машине и нажмите кнопку&nbsp;<strong>Готово</strong>&nbsp;для
                завершения создания виртуальной машины.</p>
        </li>
    </ol>
    <h3>Создание виртуальной машины с помощью PowerShell</h3>
    <ol>
        <li>
            <p>Откройте интегрированную среду сценариев PowerShell от имени администратора.</p>
        </li>
        <li>
            <p>Выполните следующий скрипт.</p>

            <pre><code><span># Set VM Name, Switch Name, and Installation Media Path.</span>
<span>$VMName</span> = <span>'TESTVM'</span>
<span>$Switch</span> = <span>'External VM Switch'</span>
<span>$InstallMedia</span> = <span>'C:\Users\Administrator\Desktop\en_windows_10_enterprise_x64_dvd_6851151.iso'</span>

<span># Create New Virtual Machine</span>
<span>New-VM</span><span> -Name</span> <span>$VMName</span><span> -MemoryStartupBytes</span> <span>2147483648</span><span> -Generation</span> <span>2</span><span> -NewVHDPath</span> <span>"D:\Virtual Machines\<span>$VMName</span>\<span>$VMName</span>.vhdx"</span><span> -NewVHDSizeBytes</span> <span>53687091200</span><span> -Path</span> <span>"D:\Virtual Machines\<span>$VMName</span>"</span><span> -SwitchName</span> <span>$Switch</span>

<span># Add DVD Drive to Virtual Machine</span>
<span>Add-VMScsiController</span><span> -VMName</span> <span>$VMName</span>
<span>Add-VMDvdDrive</span><span> -VMName</span> <span>$VMName</span><span> -ControllerNumber</span> <span>1</span><span> -ControllerLocation</span> <span>0</span><span> -Path</span> <span>$InstallMedia</span>

<span># Mount Installation Media</span>
<span>$DVDDrive</span> = <span>Get-VMDvdDrive</span><span> -VMName</span> <span>$VMName</span>

<span># Configure Virtual Machine to Boot from DVD</span>
<span>Set-VMFirmware</span><span> -VMName</span> <span>$VMName</span><span> -FirstBootDevice</span> <span>$DVDDrive</span>
</code></pre>
        </li>
    </ol>
    <h3>Завершение развертывания операционной системы</h3>
    <p>Чтобы завершить создание виртуальной машины, необходимо ее запустить и выполнить пошаговые инструкции по
        установке операционной системы.</p>
    <ol>
        <li>
            <p>В диспетчере Hyper-V дважды щелкните виртуальную машину. Запустится средство VMConnect.</p>
        </li>
        <li>
            <p>В VMConnect нажмите зеленую кнопку "Пуск". Это аналогично нажатию кнопки питания на физическом
                компьютере. Нажмите любую клавишу для загрузки с компакт- или DVD-диска при появлении соответствующего
                запроса.</p>
            <blockquote>
                <p><strong>Примечание.</strong>&nbsp;Чтобы убедиться, что нажатия клавиш отправляются в виртуальную
                    машину, щелкните внутри окна VMConnect.</p>
            </blockquote>
        </li>
        <li>
            <p>Виртуальная машина загрузится для установки, и можно будет выполнить пошаговую установку аналогично
                процедуре на физическом компьютере.</p>
            <p class="img"><img src="zagruzka_i_ustanovka_programmnogo_obespecheniya6_pic3.png" /></p>
            <blockquote>
                <p><strong>Примечание.</strong>&nbsp;Если вы не используете корпоративную лицензию на Windows, требуется
                    отдельная лицензия для Windows, установленная в виртуальной машине. Операционная система виртуальной
                    машины не зависит от операционной системы узла.</p>
            </blockquote>
        </li>
    </ol>
    <div class="next"><a href="zagruzka_i_ustanovka_programmnogo_obespecheniya7.html">Следующая лекция</a></div>
</div>
<div id="vis">
    <div class="font">
        Размер шрифта:</div>
    <div class="fontA" onclick="fonta()">А</div>
    <div class="fontAA" onclick="fontaa()">А</div>
    <div class="fontAAA" onclick="fontaaa()">А</div>
    <div class="color">Цвет сайта:</div>
    <div class="colorW" onclick="clwhite()">A</div>
    <div class="colorBK" onclick="clblack()">A</div>
    <div class="colorBE" onclick="clblue()">A</div>
    <div class="imgOnOff">Изображение:</div>
    <div class="imgOn" onclick="imgon()">Вкл.</div>
    <div class="imgOff" onclick="imgoff()">Выкл.</div>
    <div id="exit" onclick="clc()" title="Закрыть">Обычная версия</div>
</div>